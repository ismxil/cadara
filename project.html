<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project | Ismail Ahmad</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="style.css">
    <script src="tailwind.config.js"></script>
</head>

<body
    class="bg-brand-black text-brand-red font-serif selection:bg-brand-red selection:text-brand-black min-h-screen px-4">

    <main class="max-w-sm mx-auto">
        <!-- NAV Starts here-->
        <!-- Header with Logo and Hamburger Menu -->
        <div class="flex justify-between items-center mt-12">
            <a href="index.html" class="flex justify-center items-center">
                <svg class="w-8 h-8 logo" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="19.8924" cy="19.8924" r="18.6475" stroke="currentColor" stroke-width="2.48974" />
                    <path d="M19.703 1.3706L7.38959 33.6143" stroke="currentColor" stroke-width="2.48974" />
                    <path d="M18.6145 7.31771L33.1972 32.5316" stroke="currentColor" stroke-width="6.90648" />
                    <path
                        d="M14.122 14.4752C6.64759 15.2002 1.24487 17.2957 1.24487 19.7676C1.24487 22.8405 9.59363 25.3316 19.8924 25.3316C30.1911 25.3316 38.5398 22.8405 38.5398 19.7676C38.5398 17.2701 33.0246 15.1569 25.4299 14.4531"
                        stroke="currentColor" stroke-width="2.48974" />
                    <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M20.8605 30.2672L22.5437 30.4788C22.7748 30.5077 22.8643 30.791 22.6966 30.948L21.4593 32.1087L21.7782 33.7749C21.8216 34.0024 21.5816 34.1764 21.3792 34.0649L19.8929 33.2469L18.4066 34.0652C18.2042 34.1766 17.9639 34.0025 18.0076 33.7752L18.3265 32.1089L17.0891 30.948C16.9215 30.7907 17.0112 30.5077 17.2421 30.4788L18.9253 30.2672L19.6464 28.7322C19.7451 28.5221 20.0408 28.5221 20.1395 28.7322L20.8605 30.2672Z"
                        fill="currentColor" />
                </svg>
            </a>
            <!-- Hamburger Menu Button -->
            <button id="menu-toggle" class="relative w-8 h-8 flex flex-col justify-center items-center group"
                aria-label="Toggle Menu">
                <span class="hamburger-line w-6 h-0.5 bg-current transition-all duration-300 ease-in-out"></span>
                <span class="hamburger-line w-6 h-0.5 bg-current transition-all duration-300 ease-in-out mt-1.5"></span>
                <span class="hamburger-line w-6 h-0.5 bg-current transition-all duration-300 ease-in-out mt-1.5"></span>
            </button>
        </div>

        <!-- Mobile Navigation Overlay -->
        <div id="nav-overlay"
            class="fixed inset-0 bg-brand-black z-50 opacity-0 pointer-events-none transition-opacity duration-300">
            <div class="h-full flex flex-col max-w-sm mx-auto">
                <!-- Header with Logo and Close Button -->
                <div class="flex justify-between items-center mt-12">
                    <a href="index.html" class="flex justify-center items-center">
                        <svg class="w-8 h-8 logo" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="19.8924" cy="19.8924" r="18.6475" stroke="currentColor"
                                stroke-width="2.48974" />
                            <path d="M19.703 1.3706L7.38959 33.6143" stroke="currentColor" stroke-width="2.48974" />
                            <path d="M18.6145 7.31771L33.1972 32.5316" stroke="currentColor" stroke-width="6.90648" />
                            <path
                                d="M14.122 14.4752C6.64759 15.2002 1.24487 17.2957 1.24487 19.7676C1.24487 22.8405 9.59363 25.3316 19.8924 25.3316C30.1911 25.3316 38.5398 22.8405 38.5398 19.7676C38.5398 17.2701 33.0246 15.1569 25.4299 14.4531"
                                stroke="currentColor" stroke-width="2.48974" />
                            <path fill-rule="evenodd" clip-rule="evenodd"
                                d="M20.8605 30.2672L22.5437 30.4788C22.7748 30.5077 22.8643 30.791 22.6966 30.948L21.4593 32.1087L21.7782 33.7749C21.8216 34.0024 21.5816 34.1764 21.3792 34.0649L19.8929 33.2469L18.4066 34.0652C18.2042 34.1766 17.9639 34.0025 18.0076 33.7752L18.3265 32.1089L17.0891 30.948C16.9215 30.7907 17.0112 30.5077 17.2421 30.4788L18.9253 30.2672L19.6464 28.7322C19.7451 28.5221 20.0408 28.5221 20.1395 28.7322L20.8605 30.2672Z"
                                fill="currentColor" />
                        </svg>
                    </a>
                    <!-- Close Button -->
                    <button id="menu-close" class="relative w-8 h-8 flex flex-col justify-center items-center"
                        aria-label="Close Menu">
                        <span
                            class="w-6 h-0.5 bg-current transition-all duration-300 ease-in-out rotate-45 absolute"></span>
                        <span
                            class="w-6 h-0.5 bg-current transition-all duration-300 ease-in-out -rotate-45 absolute"></span>
                    </button>
                </div>

                <!-- Navigation Items -->
                <nav class="mt-16 mb-8 nav-item transform translate-y-8 opacity-0 transition-all duration-300 ease-out"
                    style="transition-delay: 50ms;">
                    <ul class="space-y-4">
                        <li class="flex items-end justify-between group">
                            <a href="about.html"
                                class="uppercase tracking-widest text-lg md:text-2xl font-display transition-all duration-300 group-hover:pl-2">About</a>
                            <div class="flex-grow border-b border-dotted border-current mx-2 mb-1"></div>
                            <span class="font-mono text-sm md:text-lg">I</span>
                        </li>
                        <li class="flex items-end justify-between group">
                            <a href="work.html"
                                class="uppercase tracking-widest text-lg md:text-2xl font-display transition-all duration-300 group-hover:pl-2">Work</a>
                            <div class="flex-grow border-b border-dotted border-current mx-2 mb-1"></div>
                            <span class="font-mono text-sm md:text-lg">II</span>
                        </li>
                        <li class="flex items-end justify-between group">
                            <a href="expertise.html"
                                class="uppercase tracking-widest text-lg md:text-2xl font-display transition-all duration-300 group-hover:pl-2">Expertise</a>
                            <div class="flex-grow border-b border-dotted border-current mx-2 mb-1"></div>
                            <span class="font-mono text-sm md:text-lg">III</span>
                        </li>
                        <li class="flex items-end justify-between group">
                            <a href="play.html"
                                class="uppercase tracking-widest text-lg md:text-2xl font-display transition-all duration-300 group-hover:pl-2">Play</a>
                            <div class="flex-grow border-b border-dotted border-current mx-2 mb-1"></div>
                            <span class="font-mono text-sm md:text-lg">IV</span>
                        </li>
                        <li class="flex items-end justify-between group">
                            <a href="thought.html"
                                class="uppercase tracking-widest text-lg md:text-2xl font-display transition-all duration-300 group-hover:pl-2">Thought</a>
                            <div class="flex-grow border-b border-dotted border-current mx-2 mb-1"></div>
                            <span class="font-mono text-sm md:text-lg">V</span>
                        </li>
                    </ul>
                </nav>

                <!-- Social Links -->
                <div class="nav-item transform translate-y-8 opacity-0 transition-all duration-300 ease-out"
                    style="transition-delay: 100ms;">
                    <div class="flex justify-center gap-6 mt-6">
                        <a href="https://bsky.app/profile/ismailahmad.com" target="_blank"
                            class="hover:scale-110 transition-transform duration-200" aria-label="Bluesky">
                            <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24">
                                <path
                                    d="M5.202 2.857C7.954 4.922 10.913 9.11 12 11.358c1.087-2.247 4.046-6.436 6.798-8.501C20.783 1.366 24 .213 24 3.883c0 .732-.42 6.156-.667 7.037-.856 3.061-3.978 3.842-6.755 3.37 4.854.826 6.089 3.562 3.422 6.299-5.065 5.196-7.28-1.304-7.847-2.97-.104-.305-.152-.448-.153-.327 0-.121-.05.022-.153.327-.568 1.666-2.782 8.166-7.847 2.97-2.667-2.737-1.432-5.473 3.422-6.3-2.777.473-5.899-.308-6.755-3.369C.42 10.04 0 4.615 0 3.883c0-3.67 3.217-2.517 5.202-1.026" />
                            </svg>
                        </a>
                        <a href="https://pinterest.com/ismxilahmad/_profile/" target="_blank"
                            class="hover:scale-110 transition-transform duration-200" aria-label="Pinterest">
                            <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24">
                                <path
                                    d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607 0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026z" />
                            </svg>
                        </a>
                        <a href="https://linkedin.com/in/ismxil" target="_blank"
                            class="hover:scale-110 transition-transform duration-200" aria-label="LinkedIn">
                            <svg class="w-8 h-8" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path fill="currentColor"
                                    d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037c-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85c3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.06 2.06 0 0 1-2.063-2.065a2.064 2.064 0 1 1 2.063 2.065m1.782 13.019H3.555V9h3.564zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0z" />
                            </svg>
                        </a>
                        <a href="https://wandarer.com" target="_blank"
                            class="hover:scale-110 transition-transform duration-200" aria-label="Substack">
                            <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24">
                                <path
                                    d="M22.539 8.242H1.46V5.406h21.08v2.836zM1.46 10.812V24L12 18.11 22.54 24V10.812H1.46zM22.54 0H1.46v2.836h21.08V0z" />
                            </svg>
                        </a>
                        <a href="https://github.com/ismxil" target="_blank"
                            class="hover:scale-110 transition-transform duration-200" aria-label="GitHub">
                            <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24">
                                <path
                                    d="M12 .297c-6.63 0-12 5.373-12 12c0 5.303 3.438 9.8 8.205 11.385c.6.113.82-.258.82-.577c0-.285-.01-1.04-.015-2.04c-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729c1.205.084 1.838 1.236 1.838 1.236c1.07 1.835 2.809 1.305 3.495.998c.108-.776.417-1.305.76-1.605c-2.665-.3-5.466-1.332-5.466-5.93c0-1.31.465-2.38 1.235-3.22c-.135-.303-.54-1.523.105-3.176c0 0 1.005-.322 3.3 1.23c.96-.267 1.98-.399 3-.405c1.02.006 2.04.138 3 .405c2.28-1.552 3.285-1.23 3.285-1.23c.645 1.653.24 2.873.12 3.176c.765.84 1.23 1.91 1.23 3.22c0 4.61-2.805 5.625-5.475 5.92c.42.36.81 1.096.81 2.22c0 1.606-.015 2.896-.015 3.286c0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12" />
                            </svg>
                        </a>
                        <a href="mailto:work@ismailahmad.com" class="hover:scale-110 transition-transform duration-200"
                            aria-label="Email">
                            <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24">
                                <path
                                    d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z" />
                            </svg>
                        </a>
                    </div>
                </div>

                <!-- Footer Info -->
                <footer
                    class="mt-8 opacity-80 text-center nav-item transform translate-y-8 opacity-0 transition-all duration-300 ease-out"
                    style="transition-delay: 150ms;">
                    <p class="text-xs text-center font-mono uppercase tracking-widest mb-2">(c) 2026</p>
                    <div class="flex justify-center items-center mt-4">
                        <a href="#" id="menu-color-randomizer" class="hover:scale-110 transition-transform duration-200"
                            aria-label="Randomize Colors">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                                <path fill="currentColor"
                                    d="M15.98 1.804a1 1 0 0 0-1.96 0l-.24 1.192a1 1 0 0 1-.784.785l-1.192.238a1 1 0 0 0 0 1.962l1.192.238a1 1 0 0 1 .785.785l.238 1.192a1 1 0 0 0 1.962 0l.238-1.192a1 1 0 0 1 .785-.785l1.192-.238a1 1 0 0 0 0-1.962l-1.192-.238a1 1 0 0 1-.785-.785zm-9.031 3.88a1 1 0 0 0-1.898 0l-.683 2.051a1 1 0 0 1-.633.633l-2.051.683a1 1 0 0 0 0 1.898l2.051.684a1 1 0 0 1 .633.632l.683 2.051a1 1 0 0 0 1.898 0l.683-2.051a1 1 0 0 1 .633-.633l2.051-.683a1 1 0 0 0 0-1.898l-2.051-.683a1 1 0 0 1-.633-.633zm7 8a1 1 0 0 0-1.898 0l-.184.551a1 1 0 0 1-.632.633l-.551.183a1 1 0 0 0 0 1.898l.551.183a1 1 0 0 1 .633.633l.183.551a1 1 0 0 0 1.898 0l.184-.551a1 1 0 0 1 .632-.633l.551-.183a1 1 0 0 0 0-1.898l-.551-.184a1 1 0 0 1-.633-.632z" />
                            </svg>
                        </a>
                    </div>
                </footer>
            </div>
        </div>
        <!-- NAV Ends here-->

        <!-- Back Link -->
        <a href="work.html"
            class="inline-flex items-center gap-2 mt-8 mb-6 text-sm font-mono uppercase tracking-widest opacity-70 hover:opacity-100 transition-opacity">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M19 12H5M12 19l-7-7 7-7" />
            </svg>
            Back to Work
        </a>

        <!-- Project Content Area -->
        <article id="project-container">
            <!-- Loading State -->
            <div id="project-loading" class="py-16 text-center">
                <div
                    class="inline-block w-6 h-6 border-2 border-current border-t-transparent rounded-full animate-spin mb-4">
                </div>
                <p class="font-mono text-sm uppercase tracking-widest opacity-70">Loading project...</p>
            </div>

            <!-- Error State (hidden by default) -->
            <div id="project-error" class="py-16 text-center hidden">
                <p class="font-display text-2xl uppercase mb-4">Project not found</p>
                <p class="text-sm opacity-70 mb-6">This project couldn't be loaded.</p>
                <a href="work.html"
                    class="inline-block border-2 border-current px-6 py-3 font-display text-sm uppercase tracking-widest hover:shadow-none hover:translate-x-[2px] hover:translate-y-[2px] transition-all duration-200 shadow-[2px_2px_0_currentColor]">
                    Back to Work
                </a>
            </div>

            <!-- Project Content (hidden by default) -->
            <div id="project-content" class="hidden">
                <!-- Cover Image -->
                <div class="aspect-video overflow-hidden border-2 border-current mb-8">
                    <img id="project-cover" src="" alt="" class="w-full h-full object-cover">
                </div>

                <!-- Project Header -->
                <header class="mb-8">
                    <h1 id="project-title"
                        class="font-display text-5xl md:text-6xl font-black uppercase tracking-tight mb-4"></h1>
                    <div id="project-meta" class="space-y-2 mb-6">
                        <div id="project-services" class="hidden">
                            <span class="font-display text-xs uppercase tracking-widest opacity-50">Services</span>
                            <p id="project-services-text" class="text-sm mt-0.5"></p>
                        </div>
                        <div id="project-industries" class="hidden">
                            <span class="font-display text-xs uppercase tracking-widest opacity-50">Industries</span>
                            <p id="project-industries-text" class="text-sm mt-0.5"></p>
                        </div>
                        <div id="project-role-wrap" class="hidden">
                            <span class="font-display text-xs uppercase tracking-widest opacity-50">Role</span>
                            <p id="project-role-text" class="text-sm mt-0.5"></p>
                        </div>
                    </div>
                    <!-- Outcome -->
                    <div id="project-outcome-wrap" class="hidden mb-6">
                        <span class="font-display text-xs uppercase tracking-widest opacity-50">Outcome</span>
                        <p id="project-outcome-text" class="text-sm mt-0.5"></p>
                    </div>
                    <!-- Challenges -->
                    <div id="project-challenges-wrap" class="hidden mb-6">
                        <span class="font-display text-xs uppercase tracking-widest opacity-50">Challenges</span>
                        <p id="project-challenges-text" class="text-sm mt-0.5"></p>
                    </div>
                    <!-- Visit Site Link -->
                    <a id="project-url" href="#" target="_blank"
                        class="hidden inline-flex items-center gap-2 border-2 border-current px-5 py-2.5 font-display text-sm uppercase tracking-widest hover:shadow-none hover:translate-x-[2px] hover:translate-y-[2px] transition-all duration-200 shadow-[2px_2px_0_currentColor]">
                        Visit Live Site
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6M15 3h6v6M10 14L21 3" />
                        </svg>
                    </a>
                </header>

                <!-- Notion Page Content -->
                <div id="project-body" class="project-content mb-12"></div>

                <!-- Divider -->
                <div class="border-t border-current border-dotted pt-6 mb-8"></div>
            </div>
        </article>

        <!-- More Projects Section -->
        <section id="more-projects" class="mb-16 hidden">
            <h2 class="text-2xl font-bold mb-8 opacity-80">More projects</h2>
            <div id="more-projects-list" class="space-y-6"></div>
        </section>

        <!-- Navigation Section -->
        <nav class="w-full max-w-sm">
            <ul class="space-y-4">
                <li class="flex items-end justify-between group">
                    <a href="about.html"
                        class="uppercase tracking-widest text-lg md:text-2xl font-display transition-all duration-300 group-hover:pl-2">About</a>
                    <div class="flex-grow border-b border-dotted border-current mx-2 mb-1"></div>
                    <span class="font-mono text-sm md:text-lg">I</span>
                </li>
                <li class="flex items-end justify-between group">
                    <a href="work.html"
                        class="uppercase tracking-widest text-lg md:text-2xl font-display transition-all duration-300 group-hover:pl-2">Work</a>
                    <div class="flex-grow border-b border-dotted border-current mx-2 mb-1"></div>
                    <span class="font-mono text-sm md:text-lg">II</span>
                </li>
                <li class="flex items-end justify-between group">
                    <a href="expertise.html"
                        class="uppercase tracking-widest text-lg md:text-2xl font-display transition-all duration-300 group-hover:pl-2">Expertise</a>
                    <div class="flex-grow border-b border-dotted border-current mx-2 mb-1"></div>
                    <span class="font-mono text-sm md:text-lg">III</span>
                </li>
                <li class="flex items-end justify-between group">
                    <a href="play.html"
                        class="uppercase tracking-widest text-lg md:text-2xl font-display transition-all duration-300 group-hover:pl-2">Play</a>
                    <div class="flex-grow border-b border-dotted border-current mx-2 mb-1"></div>
                    <span class="font-mono text-sm md:text-lg">IV</span>
                </li>
                <li class="flex items-end justify-between group">
                    <a href="thought.html"
                        class="uppercase tracking-widest text-lg md:text-2xl font-display transition-all duration-300 group-hover:pl-2">Thought</a>
                    <div class="flex-grow border-b border-dotted border-current mx-2 mb-1"></div>
                    <span class="font-mono text-sm md:text-lg">V</span>
                </li>
            </ul>
        </nav>

        <!-- Footer Info -->
        <footer class="my-16 opacity-80 text-center">
            <p class="text-xs text-center font-mono uppercase tracking-widest mb-2">(c) 2026</p>
            <div class="flex justify-center items-center mt-4">
                <a href="#" id="color-randomizer" class="hover:scale-110 transition-transform duration-200"
                    aria-label="Randomize Colors">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                        <path fill="currentColor"
                            d="M15.98 1.804a1 1 0 0 0-1.96 0l-.24 1.192a1 1 0 0 1-.784.785l-1.192.238a1 1 0 0 0 0 1.962l1.192.238a1 1 0 0 1 .785.785l.238 1.192a1 1 0 0 0 1.962 0l.238-1.192a1 1 0 0 1 .785-.785l1.192-.238a1 1 0 0 0 0-1.962l-1.192-.238a1 1 0 0 1-.785-.785zm-9.031 3.88a1 1 0 0 0-1.898 0l-.683 2.051a1 1 0 0 1-.633.633l-2.051.683a1 1 0 0 0 0 1.898l2.051.684a1 1 0 0 1 .633.632l.683 2.051a1 1 0 0 0 1.898 0l.683-2.051a1 1 0 0 1 .633-.633l2.051-.683a1 1 0 0 0 0-1.898l-2.051-.683a1 1 0 0 1-.633-.633zm7 8a1 1 0 0 0-1.898 0l-.184.551a1 1 0 0 1-.632.633l-.551.183a1 1 0 0 0 0 1.898l.551.183a1 1 0 0 1 .633.633l.183.551a1 1 0 0 0 1.898 0l.184-.551a1 1 0 0 1 .632-.633l.551-.183a1 1 0 0 0 0-1.898l-.551-.184a1 1 0 0 1-.633-.632z" />
                    </svg>
                </a>
            </div>
        </footer>
    </main>

    <script src="script.js"></script>
    <script src="project-cache.js"></script>
    <script src="blog-cache.js"></script>
    <script>BlogCache.getArticles(function () { });</script>
    <script>
        (function () {
            var params = new URLSearchParams(window.location.search);
            var projectId = params.get('id');

            if (!projectId) { showError(); return; }

            // Load project metadata + blocks, render when both ready
            var meta = null;
            var blocks = null;
            var metaLoaded = false;
            var blocksLoaded = false;
            var rendered = false;

            function tryRender() {
                if (rendered) return;
                if (!metaLoaded || !blocksLoaded) return;
                rendered = true;
                if (!meta) { showError(); return; }
                render();
            }

            ProjectCache.getProjects(function (projects) {
                if (!projects) {
                    meta = null;
                    metaLoaded = true;
                    tryRender();
                    return;
                }
                for (var i = 0; i < projects.length; i++) {
                    if (projects[i].id === projectId) {
                        meta = projects[i];
                        break;
                    }
                }
                metaLoaded = true;
                tryRender();
            });

            ProjectCache.getBlocks(projectId, function (data) {
                blocks = data;
                blocksLoaded = true;
                tryRender();
            });

            // Populate "More projects"
            ProjectCache.getProjects(function (projects) {
                if (!projects || projects.length < 2) return;
                var others = projects.filter(function (p) { return p.id !== projectId; });
                if (!others.length) return;

                var container = document.getElementById('more-projects-list');
                var html = '';
                others.forEach(function (p) {
                    var services = (p.services || []).join(' Â· ');
                    html += '<div class="flex gap-4 items-start">' +
                        '<div class="w-20 h-14 flex-shrink-0 border border-current overflow-hidden">' +
                        (p.cover ? '<img src="' + p.cover + '" alt="' + p.name + '" class="w-full h-full object-cover">' : '') +
                        '</div>' +
                        '<div>' +
                        '<a href="project.html?id=' + p.id + '" class="font-display text-lg uppercase tracking-wide hover:opacity-70 transition-opacity">' + p.name + '</a>' +
                        (services ? '<p class="text-xs opacity-50 mt-0.5">' + services + '</p>' : '') +
                        '</div>' +
                        '</div>';
                });
                container.innerHTML = html;
                document.getElementById('more-projects').classList.remove('hidden');
            });

            function render() {
                if (!meta) { showError(); return; }

                document.title = meta.name + ' | Ismail Ahmad';

                // Cover
                var coverEl = document.getElementById('project-cover');
                if (meta.cover) {
                    coverEl.src = meta.cover;
                    coverEl.alt = meta.name;
                } else {
                    coverEl.parentElement.classList.add('hidden');
                }

                // Title
                document.getElementById('project-title').textContent = meta.name;

                // Services
                if (meta.services && meta.services.length) {
                    document.getElementById('project-services').classList.remove('hidden');
                    document.getElementById('project-services-text').textContent = meta.services.join(' Â· ');
                }

                // Industries
                if (meta.industries && meta.industries.length) {
                    document.getElementById('project-industries').classList.remove('hidden');
                    document.getElementById('project-industries-text').textContent = meta.industries.join(' Â· ');
                }

                // Role
                if (meta.role) {
                    document.getElementById('project-role-wrap').classList.remove('hidden');
                    document.getElementById('project-role-text').textContent = meta.role;
                }

                // Outcome
                if (meta.outcome) {
                    document.getElementById('project-outcome-wrap').classList.remove('hidden');
                    document.getElementById('project-outcome-text').textContent = meta.outcome;
                }

                // Challenges
                if (meta.challenges) {
                    document.getElementById('project-challenges-wrap').classList.remove('hidden');
                    document.getElementById('project-challenges-text').textContent = meta.challenges;
                }

                // URL
                if (meta.url) {
                    var urlEl = document.getElementById('project-url');
                    urlEl.href = meta.url.startsWith('http') ? meta.url : 'https://' + meta.url;
                    urlEl.classList.remove('hidden');
                }

                // Render Notion blocks
                if (blocks && blocks.length) {
                    document.getElementById('project-body').innerHTML = renderBlocks(blocks);
                }

                // Show content, hide loading
                document.getElementById('project-loading').classList.add('hidden');
                document.getElementById('project-content').classList.remove('hidden');
            }

            /* ============================
               Notion Block â†’ HTML Renderer
               ============================ */

            function renderRichText(richTextArr) {
                if (!richTextArr || !richTextArr.length) return '';
                return richTextArr.map(function (rt) {
                    var text = rt.plain_text || '';
                    // Escape HTML
                    text = text.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
                    // Preserve newlines
                    text = text.replace(/\n/g, '<br>');
                    var ann = rt.annotations || {};
                    if (ann.bold) text = '<strong>' + text + '</strong>';
                    if (ann.italic) text = '<em>' + text + '</em>';
                    if (ann.strikethrough) text = '<del>' + text + '</del>';
                    if (ann.underline) text = '<u>' + text + '</u>';
                    if (ann.code) text = '<code>' + text + '</code>';
                    if (ann.color && ann.color !== 'default') {
                        var c = ann.color.replace('_background', '');
                        var isBg = ann.color.includes('_background');
                        text = '<span style="' + (isBg ? 'background-color' : 'color') + ':' + mapNotionColor(c) + '">' + text + '</span>';
                    }
                    if (rt.href) {
                        text = '<a href="' + rt.href + '" target="_blank" rel="noopener">' + text + '</a>';
                    }
                    return text;
                }).join('');
            }

            function mapNotionColor(c) {
                var map = {
                    gray: '#9B9A97', brown: '#64473A', orange: '#D9730D',
                    yellow: '#DFAB01', green: '#0F7B6C', blue: '#0B6E99',
                    purple: '#6940A5', pink: '#AD1A72', red: '#E03E3E'
                };
                return map[c] || 'inherit';
            }

            function renderBlocks(blockList) {
                var html = '';
                var i = 0;
                while (i < blockList.length) {
                    var block = blockList[i];
                    var type = block.type;

                    // Collect consecutive list items into a list
                    if (type === 'bulleted_list_item') {
                        html += '<ul>';
                        while (i < blockList.length && blockList[i].type === 'bulleted_list_item') {
                            html += renderListItem(blockList[i]);
                            i++;
                        }
                        html += '</ul>';
                        continue;
                    }
                    if (type === 'numbered_list_item') {
                        html += '<ol>';
                        while (i < blockList.length && blockList[i].type === 'numbered_list_item') {
                            html += renderListItem(blockList[i]);
                            i++;
                        }
                        html += '</ol>';
                        continue;
                    }

                    html += renderBlock(block);
                    i++;
                }
                return html;
            }

            function renderListItem(block) {
                var data = block[block.type] || {};
                var content = renderRichText(data.rich_text);
                // Render children if any
                if (block._children && block._children.length) {
                    content += renderBlocks(block._children);
                }
                return '<li>' + content + '</li>';
            }

            function renderBlock(block) {
                var type = block.type;
                var data = block[type] || {};

                switch (type) {
                    case 'paragraph':
                        var pText = renderRichText(data.rich_text);
                        if (!pText.trim()) return '';
                        var pHtml = '<p>' + pText + '</p>';
                        if (block._children && block._children.length) pHtml += renderBlocks(block._children);
                        return pHtml;

                    case 'heading_1':
                        return '<h2>' + renderRichText(data.rich_text) + '</h2>';

                    case 'heading_2':
                        return '<h3>' + renderRichText(data.rich_text) + '</h3>';

                    case 'heading_3':
                        return '<h4>' + renderRichText(data.rich_text) + '</h4>';

                    case 'image':
                        var imgUrl = '';
                        if (data.type === 'file') imgUrl = data.file ? data.file.url : '';
                        else if (data.type === 'external') imgUrl = data.external ? data.external.url : '';
                        var caption = data.caption ? renderRichText(data.caption) : '';
                        if (!imgUrl) return '';
                        return '<figure>' +
                            '<img src="' + imgUrl + '" alt="' + (caption.replace(/<[^>]+>/g, '') || '') + '" loading="lazy">' +
                            (caption ? '<figcaption>' + caption + '</figcaption>' : '') +
                            '</figure>';

                    case 'video':
                        var vidUrl = '';
                        if (data.type === 'file') vidUrl = data.file ? data.file.url : '';
                        else if (data.type === 'external') vidUrl = data.external ? data.external.url : '';
                        if (!vidUrl) return '';
                        // YouTube or Vimeo embed
                        if (vidUrl.match(/youtube\.com|youtu\.be/)) {
                            var ytId = vidUrl.match(/(?:v=|youtu\.be\/)([^&?]+)/);
                            if (ytId) return '<div class="project-video-embed"><iframe src="https://www.youtube.com/embed/' + ytId[1] + '" frameborder="0" allowfullscreen style="width:100%;aspect-ratio:16/9;border-radius:4px"></iframe></div>';
                        }
                        return '<video src="' + vidUrl + '" controls style="width:100%;border-radius:4px;margin:1.5em 0"></video>';

                    case 'embed':
                        var embedUrl = data.url || '';
                        if (!embedUrl) return '';
                        return '<div class="project-video-embed"><iframe src="' + embedUrl + '" frameborder="0" allowfullscreen style="width:100%;aspect-ratio:16/9;border-radius:4px"></iframe></div>';

                    case 'bookmark':
                        var bUrl = data.url || '';
                        var bCaption = data.caption ? renderRichText(data.caption) : bUrl;
                        return '<a href="' + bUrl + '" target="_blank" rel="noopener" class="block border border-current rounded px-4 py-3 my-4 hover:opacity-70 transition-opacity text-sm font-mono truncate">' + bCaption + '</a>';

                    case 'quote':
                        var qText = renderRichText(data.rich_text);
                        var qHtml = '<blockquote>' + qText + '</blockquote>';
                        if (block._children && block._children.length) qHtml = '<blockquote>' + qText + renderBlocks(block._children) + '</blockquote>';
                        return qHtml;

                    case 'callout':
                        var cIcon = '';
                        if (data.icon) {
                            if (data.icon.type === 'emoji') cIcon = data.icon.emoji + ' ';
                        }
                        var cText = renderRichText(data.rich_text);
                        return '<div class="callout" style="border-left:3px solid currentColor;padding:1em;margin:1.5em 0;opacity:0.9;background:color-mix(in srgb, currentColor 5%, transparent);border-radius:4px">' +
                            '<p>' + cIcon + cText + '</p>' +
                            (block._children && block._children.length ? renderBlocks(block._children) : '') +
                            '</div>';

                    case 'code':
                        var codeText = data.rich_text ? data.rich_text.map(function (r) { return r.plain_text || ''; }).join('') : '';
                        codeText = codeText.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
                        var lang = data.language || '';
                        return '<pre><code' + (lang ? ' class="language-' + lang + '"' : '') + '>' + codeText + '</code></pre>';

                    case 'divider':
                        return '<hr>';

                    case 'toggle':
                        var toggleText = renderRichText(data.rich_text);
                        return '<details style="margin:1em 0"><summary style="cursor:pointer;font-weight:700">' + toggleText + '</summary>' +
                            '<div style="padding:0.5em 0 0 1em">' +
                            (block._children && block._children.length ? renderBlocks(block._children) : '') +
                            '</div></details>';

                    case 'to_do':
                        var checked = data.checked ? 'checked' : '';
                        return '<div style="display:flex;gap:0.5em;align-items:flex-start;margin:0.25em 0"><input type="checkbox" ' + checked + ' disabled style="margin-top:0.3em"><span>' + renderRichText(data.rich_text) + '</span></div>';

                    case 'child_page':
                        return '<p class="font-display text-sm uppercase tracking-widest opacity-50 my-4">ðŸ“„ ' + (data.title || 'Subpage') + '</p>';

                    case 'child_database':
                        return '<p class="font-display text-sm uppercase tracking-widest opacity-50 my-4">ðŸ“Š ' + (data.title || 'Database') + '</p>';

                    case 'table':
                        if (!block._children || !block._children.length) return '';
                        var tableHtml = '<table>';
                        block._children.forEach(function (row, rowIdx) {
                            var rowData = row.table_row || {};
                            var cells = rowData.cells || [];
                            tableHtml += '<tr>';
                            cells.forEach(function (cell) {
                                var tag = (data.has_column_header && rowIdx === 0) ? 'th' : 'td';
                                tableHtml += '<' + tag + '>' + renderRichText(cell) + '</' + tag + '>';
                            });
                            tableHtml += '</tr>';
                        });
                        tableHtml += '</table>';
                        return tableHtml;

                    case 'column_list':
                        if (!block._children || !block._children.length) return '';
                        var colCount = block._children.length;
                        var colHtml = '<div style="display:grid;grid-template-columns:repeat(' + colCount + ',1fr);gap:1em;margin:1em 0">';
                        block._children.forEach(function (col) {
                            colHtml += '<div>' + (col._children ? renderBlocks(col._children) : '') + '</div>';
                        });
                        colHtml += '</div>';
                        return colHtml;

                    case 'column':
                        // Handled by column_list
                        return block._children ? renderBlocks(block._children) : '';

                    default:
                        return '';
                }
            }

            function showError() {
                console.error('Project load failed. ID:', projectId, 'meta:', meta, 'blocks:', blocks, 'metaLoaded:', metaLoaded, 'blocksLoaded:', blocksLoaded);
                document.getElementById('project-loading').classList.add('hidden');
                document.getElementById('project-error').classList.remove('hidden');
            }
        })();
    </script>
</body>

</html>